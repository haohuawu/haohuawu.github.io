<!DOCTYPE html><html><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=0"><title>Mac 下搭建 nginx + mysql + php + fpm</title><meta name="description" content="homebrew安装 homebrew1/usr/bin/ruby -e &quot;$(curl -fsSL https://raw.githubusercontent.com/Homebrew/install/master/install)&quot;homebrew 帮助文档 man brewnginx安装 nginx1brew install nginx配置 nginx安装完成后通过 brew info ng"><meta property="og:type" content="article"><meta property="og:title" content="Mac 下搭建 nginx + mysql + php + fpm"><meta property="og:url" content="https://haohuawu.github.io/2017/03/31/mac-setup-nginx-mysql-php-fpm/index.html"><meta property="og:site_name" content="天枢"><meta property="og:description" content="homebrew安装 homebrew1/usr/bin/ruby -e &quot;$(curl -fsSL https://raw.githubusercontent.com/Homebrew/install/master/install)&quot;homebrew 帮助文档 man brewnginx安装 nginx1brew install nginx配置 nginx安装完成后通过 brew info ng"><meta property="og:image" content="https://haohuawu.github.io/assets/images/mac-sequelpro.png"><meta property="og:updated_time" content="2017-05-30T12:53:36.000Z"><meta name="twitter:card" content="summary"><meta name="twitter:title" content="Mac 下搭建 nginx + mysql + php + fpm"><meta name="twitter:description" content="homebrew安装 homebrew1/usr/bin/ruby -e &quot;$(curl -fsSL https://raw.githubusercontent.com/Homebrew/install/master/install)&quot;homebrew 帮助文档 man brewnginx安装 nginx1brew install nginx配置 nginx安装完成后通过 brew info ng"><meta name="twitter:image" content="https://haohuawu.github.io/assets/images/mac-sequelpro.png"><link rel="stylesheet" href="/assets/blog/styles/main.css"></head><body><header class="site--header" role="banner"><div class="wrapper"><a class="site--title" href="/">天枢</a> <a class="nav-menu" href="javascript: void 0;"><svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 32 32"><path fill="#424242" d="M2 6.667h28v3.135h-28v-3.135zM2 17.531v-3.063h28v3.063h-28zM2 25.333v-3.135h28v3.135h-28z"></path></svg></a></div></header><main class="site--content" aria-label="Content"><div class="wrapper"><article id="post-mac-setup-nginx-mysql-php-fpm" class="post" data-layout="post" data-site-index="post" itemscope itemprop="blogPost"><!-- title --><h1 class="post-title" itemprop="name">Mac 下搭建 nginx + mysql + php + fpm</h1><!-- meta --><div class="post-meta"><span class="post-date post-meta--item"><span class="icon icon---date"><svg version="1.1" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 28 28"><path fill="#828282" d="M14.714 7.049v7.275l6.236 3.703-1.039 1.754-7.275-4.417v-8.315h2.079zM14 25.108c6.106 0 11.108-5.002 11.108-11.108s-5.002-11.108-11.108-11.108-11.108 5.002-11.108 11.108 5.002 11.108 11.108 11.108zM14 0.164c7.665 0 13.836 6.171 13.836 13.836s-6.171 13.836-13.836 13.836-13.836-6.171-13.836-13.836 6.171-13.836 13.836-13.836z"></path></svg> </span><time datetime="2017-03-31T12:17:22.000Z" itemprop="datePublished">2017-03-31</time></span><div class="post-tags post-meta--item"><span class="icon icon---tag"><svg version="1.1" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 28 28"><path fill="#828282" d="M26.688 0h-10.5c-0.722 0-1.73 0.418-2.241 0.928l-13.019 13.019c-0.51 0.51-0.51 1.346 0 1.856l11.269 11.269c0.51 0.51 1.346 0.51 1.856 0l13.019-13.019c0.51-0.51 0.928-1.519 0.928-2.241v-10.5c0-0.722-0.591-1.313-1.313-1.313zM20.125 10.5c-1.45 0-2.625-1.175-2.625-2.625s1.175-2.625 2.625-2.625 2.625 1.175 2.625 2.625-1.175 2.625-2.625 2.625z"></path></svg></span><ul class="tag-list"><li class="tag-list--item"><a class="tag-list--link" href="/tags/mac/">#Mac</a></li><li class="tag-list--item"><a class="tag-list--link" href="/tags/nginx/">#nginx</a></li><li class="tag-list--item"><a class="tag-list--link" href="/tags/mysql/">#mysql</a></li><li class="tag-list--item"><a class="tag-list--link" href="/tags/php/">#php</a></li><li class="tag-list--item"><a class="tag-list--link" href="/tags/php-fpm/">#php-fpm</a></li><li class="tag-list--item"><a class="tag-list--link" href="/tags/homebrew/">#homebrew</a></li></ul></div></div><!-- gallery --><!-- entry --><main class="post--entry" itemprop="articleBody"><h3 id="homebrew"><a href="#homebrew" class="headerlink" title="homebrew"></a>homebrew</h3><h4 id="安装-homebrew"><a href="#安装-homebrew" class="headerlink" title="安装 homebrew"></a>安装 homebrew</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">/usr/bin/ruby <span class="_">-e</span> <span class="string">"<span class="variable">$(curl -fsSL https://raw.githubusercontent.com/Homebrew/install/master/install)</span>"</span></div></pre></td></tr></table></figure><p>homebrew 帮助文档 <code>man brew</code></p><h3 id="nginx"><a href="#nginx" class="headerlink" title="nginx"></a>nginx</h3><h4 id="安装-nginx"><a href="#安装-nginx" class="headerlink" title="安装 nginx"></a>安装 nginx</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">brew install nginx</div></pre></td></tr></table></figure><h4 id="配置-nginx"><a href="#配置-nginx" class="headerlink" title="配置 nginx"></a>配置 nginx</h4><p>安装完成后通过 <code>brew info nginx</code> 查看安装信息，nginx 配置文件目录在 <code>/usr/local/etc/nginx/</code> 下，通过 <code>nginx.conf</code> 主配置文件可以知道，nginx 会加载当前目录 <code>servers</code> 下所有的配置文件。现在我们新增配置文件 <code>localhost-700.conf</code> 来监听本地 700 端口的所有请求：</p><figure class="highlight nginx"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line"><span class="section">server</span> &#123;</div><div class="line">  <span class="attribute">listen</span>  <span class="number">700</span>;</div><div class="line">  <span class="attribute">server_name</span> localhost;</div><div class="line">  <span class="attribute">root</span>    /Users/your/home/dir/www;</div><div class="line">  <span class="attribute">index</span>   index.html index.htm index.php;</div><div class="line"></div><div class="line">  <span class="attribute">location</span> / &#123;</div><div class="line">    <span class="attribute">autoindex</span> <span class="literal">on</span>; <span class="comment"># 开启目录浏览功能  </span></div><div class="line">    <span class="attribute">autoindex_exact_size</span> <span class="literal">off</span>; <span class="comment"># 关闭详细文件大小统计，让文件大小显示MB，GB单位，默认为b</span></div><div class="line">    <span class="attribute">autoindex_localtime</span> <span class="literal">on</span>; <span class="comment"># 开启以服务器本地时区显示文件修改日期</span></div><div class="line">  &#125;</div><div class="line"></div><div class="line">  <span class="attribute">location</span> <span class="regexp">~ \.php$</span> &#123;</div><div class="line">    <span class="attribute">fastcgi_pass</span>  <span class="number">127.0.0.1:9000</span>;</div><div class="line">    <span class="attribute">fastcgi_index</span> index.php;</div><div class="line">    <span class="attribute">include</span>       fastcgi.conf;</div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure><h4 id="启动并测试-nginx"><a href="#启动并测试-nginx" class="headerlink" title="启动并测试 nginx"></a>启动并测试 nginx</h4><figure class="highlight nginx"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># 测试配置是否有语法错误</span></div><div class="line"><span class="attribute">nginx</span> -t</div><div class="line"></div><div class="line"><span class="comment"># 启动 nginx</span></div><div class="line">sudo nginx</div><div class="line"></div><div class="line"><span class="comment"># 重新加载配置|重启|停止|退出 nginx</span></div><div class="line">sudo nginx -s reload|reopen|stop|quit</div></pre></td></tr></table></figure><h4 id="自启动-nginx"><a href="#自启动-nginx" class="headerlink" title="自启动 nginx"></a>自启动 nginx</h4><p>Nginx 监听 <code>1000</code> 以下的端口需要 <code>root</code> 权限执行，所以应当使用 <code>sudo</code> 执行相关操作：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">sudo launchctl load -w ~/Library/LaunchAgents/homebrew.mxcl.nginx.plist</div></pre></td></tr></table></figure><p>取消开机自动启动服务：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">sudo launchctl unload ~/Library/LaunchAgents/homebrew.mxcl.nginx.plist</div></pre></td></tr></table></figure><h3 id="mysql"><a href="#mysql" class="headerlink" title="mysql"></a>mysql</h3><h4 id="安装及配置-mysql"><a href="#安装及配置-mysql" class="headerlink" title="安装及配置 mysql"></a>安装及配置 mysql</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># 安装</span></div><div class="line">brew install mysql</div><div class="line"></div><div class="line"><span class="comment"># 启动 mysql</span></div><div class="line">mysql.server start</div><div class="line"></div><div class="line"><span class="comment"># 初始化 mysql 配置</span></div><div class="line">mysql_secure_installation</div><div class="line"></div><div class="line"><span class="comment"># 登录 mysql</span></div><div class="line">mysql -uroot -p</div><div class="line"></div><div class="line"><span class="comment"># 添加新用户并配置密码及权限</span></div><div class="line">CREATE USER <span class="string">'newuser'</span>@<span class="string">'localhost'</span> IDENTIFIED BY <span class="string">'password'</span>;</div><div class="line">GRANT ALL PRIVILEGES ON * . * TO <span class="string">'newuser'</span>@<span class="string">'localhost'</span>;</div><div class="line">FLUSH PRIVILEGES;</div></pre></td></tr></table></figure><h4 id="mysql-自启动"><a href="#mysql-自启动" class="headerlink" title="mysql 自启动"></a>mysql 自启动</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">sudo launchctl load -w ~/Library/LaunchAgents/homebrew.mxcl.mysql.plist</div></pre></td></tr></table></figure><h4 id="安装-mysql-图形化工具"><a href="#安装-mysql-图形化工具" class="headerlink" title="安装 mysql 图形化工具"></a>安装 mysql 图形化工具</h4><p><a href="http://sequelpro.com/" target="_blank" rel="external">Sequel Pro</a></p><p><img src="/assets/images/mac-sequelpro.png" alt="Sequel Pro"></p><h3 id="php-及-php-fpm"><a href="#php-及-php-fpm" class="headerlink" title="php 及 php-fpm"></a>php 及 php-fpm</h3><h4 id="配置-php"><a href="#配置-php" class="headerlink" title="配置 php"></a>配置 php</h4><p>Mac 自带 php 及 php-fpm，只需要配置一下就行：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># 查看默认的 php 的编译参数</span></div><div class="line">php -i | grep config</div><div class="line"></div><div class="line"><span class="comment"># 根据上面输出，需要在 /etc 目录下创建 php.ini</span></div><div class="line">sudo cp /etc/php.ini.default  /etc/php.ini</div><div class="line"></div><div class="line"><span class="comment"># 变更 owner:</span></div><div class="line">chown &lt;你的用户名&gt; /etc/php.ini</div><div class="line">chmod u+w /etc/php.ini</div></pre></td></tr></table></figure><h4 id="配置-fpm"><a href="#配置-fpm" class="headerlink" title="配置 fpm"></a>配置 fpm</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># 创建配置文件 php-fpm.conf</span></div><div class="line">sudo cp /private/etc/php-fpm.conf.default /private/etc/php-fpm.conf</div><div class="line"></div><div class="line"><span class="comment"># 修改默认的日志和 pid 配置</span></div><div class="line">vi /usr/<span class="built_in">local</span>/etc/php-fpm.conf</div><div class="line"></div><div class="line">pid = /usr/<span class="built_in">local</span>/var/run/php-fpm.pid</div><div class="line">error_log = /usr/<span class="built_in">local</span>/var/<span class="built_in">log</span>/php-fpm.log</div><div class="line"></div><div class="line"><span class="comment"># 启动 fpm，默认监听 9000 端口</span></div><div class="line">php-fpm</div><div class="line"></div><div class="line"><span class="comment"># 停止 fpm</span></div><div class="line">sudo pkill php-fpm</div></pre></td></tr></table></figure><h4 id="fpm-自启动"><a href="#fpm-自启动" class="headerlink" title="fpm 自启动"></a>fpm 自启动</h4><p>在 <code>~/Library/LaunchAgents/</code> 下新建 fpm 自启动配置文件 <code>org.php.php-fpm.plist</code>：</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</div><div class="line"><span class="meta">&lt;!DOCTYPE plist PUBLIC "-//Apple//DTD PLIST 1.0//EN" "http://www.apple.com/DTDs/PropertyList-1.0.dtd"&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">plist</span> <span class="attr">version</span>=<span class="string">"1.0"</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">dict</span>&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">key</span>&gt;</span>KeepAlive<span class="tag">&lt;/<span class="name">key</span>&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">true</span>/&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">key</span>&gt;</span>Label<span class="tag">&lt;/<span class="name">key</span>&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">string</span>&gt;</span>php-fpm<span class="tag">&lt;/<span class="name">string</span>&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">key</span>&gt;</span>Program<span class="tag">&lt;/<span class="name">key</span>&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">string</span>&gt;</span>/usr/sbin/php-fpm<span class="tag">&lt;/<span class="name">string</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">dict</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">plist</span>&gt;</span></div></pre></td></tr></table></figure><p>自启动：<code>launchctl load -w ~/Library/LaunchAgents/org.php.php-fpm.plist</code></p><p>参考</p><ul><li><p><a href="https://brew.sh/" target="_blank" rel="external">homebrew</a></p></li><li><p><a href="https://lzw.me/a/mac-osx-php-fpm-nginx-mysql.html" target="_blank" rel="external">Mac OS X 系统自带的 php-fpm 配置和 nginx、mysql 的安装</a></p></li></ul></main><!-- navigation --><nav class="post-nav"><a href="/2017/05/01/fe-knowledge/" class="post-nav--link"><strong class="post-nav--caption">上一篇</strong><div class="post-nav--title">前端知识图谱</div></a><a href="/2017/03/28/css-specific-and-priority/" class="post-nav--link"><strong class="post-nav--caption">下一篇</strong><div class="post-nav--title">CSS 权重及优先级</div></a></nav><!-- footer --></article><aside class="side-bar"><div class="side-bar--wrapper"><nav class="post-nav"><a href="/2017/05/01/fe-knowledge/" class="post-nav--link"><strong class="post-nav--caption">上一篇</strong> </a><a href="/2017/03/28/css-specific-and-priority/" class="post-nav--link"><strong class="post-nav--caption">下一篇</strong></a></nav><!-- toc --><ul class="toc"><li class="toc--item"><a title="homebrew" class="toc--item--anchor" href="#homebrew" data-depth="0"><span class="toc--number">1</span>homebrew</a></li><li class="toc--item"><a title="安装 homebrew" class="toc--item--anchor" href="#安装-homebrew" data-depth="1"><span class="toc--number">1.1</span>安装 homebrew</a></li><li class="toc--item"><a title="nginx" class="toc--item--anchor" href="#nginx" data-depth="0"><span class="toc--number">2</span>nginx</a></li><li class="toc--item"><a title="安装 nginx" class="toc--item--anchor" href="#安装-nginx" data-depth="1"><span class="toc--number">2.1</span>安装 nginx</a></li><li class="toc--item"><a title="配置 nginx" class="toc--item--anchor" href="#配置-nginx" data-depth="1"><span class="toc--number">2.2</span>配置 nginx</a></li><li class="toc--item"><a title="启动并测试 nginx" class="toc--item--anchor" href="#启动并测试-nginx" data-depth="1"><span class="toc--number">2.3</span>启动并测试 nginx</a></li><li class="toc--item"><a title="自启动 nginx" class="toc--item--anchor" href="#自启动-nginx" data-depth="1"><span class="toc--number">2.4</span>自启动 nginx</a></li><li class="toc--item"><a title="mysql" class="toc--item--anchor" href="#mysql" data-depth="0"><span class="toc--number">3</span>mysql</a></li><li class="toc--item"><a title="安装及配置 mysql" class="toc--item--anchor" href="#安装及配置-mysql" data-depth="1"><span class="toc--number">3.1</span>安装及配置 mysql</a></li><li class="toc--item"><a title="mysql 自启动" class="toc--item--anchor" href="#mysql-自启动" data-depth="1"><span class="toc--number">3.2</span>mysql 自启动</a></li><li class="toc--item"><a title="安装 mysql 图形化工具" class="toc--item--anchor" href="#安装-mysql-图形化工具" data-depth="1"><span class="toc--number">3.3</span>安装 mysql 图形化工具</a></li><li class="toc--item"><a title="php 及 php-fpm" class="toc--item--anchor" href="#php-及-php-fpm" data-depth="0"><span class="toc--number">4</span>php 及 php-fpm</a></li><li class="toc--item"><a title="配置 php" class="toc--item--anchor" href="#配置-php" data-depth="1"><span class="toc--number">4.1</span>配置 php</a></li><li class="toc--item"><a title="配置 fpm" class="toc--item--anchor" href="#配置-fpm" data-depth="1"><span class="toc--number">4.2</span>配置 fpm</a></li><li class="toc--item"><a title="fpm 自启动" class="toc--item--anchor" href="#fpm-自启动" data-depth="1"><span class="toc--number">4.3</span>fpm 自启动</a></li></ul></div></aside></div></main><footer class="site--footer"><div class="wrapper"><h2 class="footer--heading">天枢</h2><div class="footer-col-wrapper"><div class="footer-col footer-col---3"><ul class="slash-list"><li>他强由他强，清风拂山岗</li><li><a rel="license" href="http://creativecommons.org/licenses/by-nc-nd/3.0/"><img alt="知识共享许可协议" style="border-width: 0" src="https://i.creativecommons.org/l/by-nc-nd/3.0/80x15.png"></a></li></ul></div></div></div></footer><script src="/assets/blog/js/manifest.js"></script><script src="/assets/blog/js/vendor.js"></script><script src="/assets/blog/js/main.js"></script></body></html>