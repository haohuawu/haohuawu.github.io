<!DOCTYPE html><html><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=0"><title>谈谈 CSS 架构</title><meta name="description" content="良好的 CSS 架构一个好的架构是可预测的、拥抱变化的、低耦合的以及弹性可扩展的，CSS 也不例外。"><meta property="og:type" content="article"><meta property="og:title" content="谈谈 CSS 架构"><meta property="og:url" content="https://haohuawu.github.io/2017/03/28/talking-about-css-architecture/index.html"><meta property="og:site_name" content="天枢"><meta property="og:description" content="良好的 CSS 架构一个好的架构是可预测的、拥抱变化的、低耦合的以及弹性可扩展的，CSS 也不例外。"><meta property="og:updated_time" content="2017-05-30T12:52:50.000Z"><meta name="twitter:card" content="summary"><meta name="twitter:title" content="谈谈 CSS 架构"><meta name="twitter:description" content="良好的 CSS 架构一个好的架构是可预测的、拥抱变化的、低耦合的以及弹性可扩展的，CSS 也不例外。"><link rel="stylesheet" href="/assets/blog/styles/main.css"></head><body><header class="site--header" role="banner"><div class="wrapper"><a class="site--title" href="/">天枢</a> <a class="nav-menu" href="javascript: void 0;"><svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 32 32"><path fill="#424242" d="M2 6.667h28v3.135h-28v-3.135zM2 17.531v-3.063h28v3.063h-28zM2 25.333v-3.135h28v3.135h-28z"></path></svg></a></div></header><main class="site--content" aria-label="Content"><div class="wrapper"><article id="post-talking-about-css-architecture" class="post" data-layout="post" data-site-index="post" itemscope itemprop="blogPost"><!-- title --><h1 class="post-title" itemprop="name">谈谈 CSS 架构</h1><!-- meta --><div class="post-meta"><span class="post-date post-meta--item"><span class="icon icon---date"><svg version="1.1" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 28 28"><path fill="#828282" d="M14.714 7.049v7.275l6.236 3.703-1.039 1.754-7.275-4.417v-8.315h2.079zM14 25.108c6.106 0 11.108-5.002 11.108-11.108s-5.002-11.108-11.108-11.108-11.108 5.002-11.108 11.108 5.002 11.108 11.108 11.108zM14 0.164c7.665 0 13.836 6.171 13.836 13.836s-6.171 13.836-13.836 13.836-13.836-6.171-13.836-13.836 6.171-13.836 13.836-13.836z"></path></svg> </span><time datetime="2017-03-28T03:32:39.000Z" itemprop="datePublished">2017-03-28</time></span><div class="post-tags post-meta--item"><span class="icon icon---tag"><svg version="1.1" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 28 28"><path fill="#828282" d="M26.688 0h-10.5c-0.722 0-1.73 0.418-2.241 0.928l-13.019 13.019c-0.51 0.51-0.51 1.346 0 1.856l11.269 11.269c0.51 0.51 1.346 0.51 1.856 0l13.019-13.019c0.51-0.51 0.928-1.519 0.928-2.241v-10.5c0-0.722-0.591-1.313-1.313-1.313zM20.125 10.5c-1.45 0-2.625-1.175-2.625-2.625s1.175-2.625 2.625-2.625 2.625 1.175 2.625 2.625-1.175 2.625-2.625 2.625z"></path></svg></span><ul class="tag-list"><li class="tag-list--item"><a class="tag-list--link" href="/tags/css/">#CSS</a></li></ul></div></div><!-- gallery --><!-- entry --><main class="post--entry" itemprop="articleBody"><h3 id="良好的-CSS-架构"><a href="#良好的-CSS-架构" class="headerlink" title="良好的 CSS 架构"></a>良好的 CSS 架构</h3><p>一个好的架构是可预测的、拥抱变化的、低耦合的以及弹性可扩展的，CSS 也不例外。</p><a id="more"></a><h4 id="可预测的"><a href="#可预测的" class="headerlink" title="可预测的"></a>可预测的</h4><p>编写可预测的 CSS 意味着对于每一条 CSS 规则的增删及改动不应该影响页面其他部分。</p><h4 id="可复用的"><a href="#可复用的" class="headerlink" title="可复用的"></a>可复用的</h4><p>CSS 规则应该充分提取并且解耦，使得新的组件能够复用 patterns。</p><h4 id="可维护的"><a href="#可维护的" class="headerlink" title="可维护的"></a>可维护的</h4><p>当添加新的功能或者修改现有功能时，不应该需要重构现有的 CSS，新增的组件同样不能影响现有组件。</p><h4 id="弹性伸缩的"><a href="#弹性伸缩的" class="headerlink" title="弹性伸缩的"></a>弹性伸缩的</h4><p>随着业务量及复杂度的增加，弹性伸缩的 CSS 能够保持简单。</p><h3 id="一些反模式"><a href="#一些反模式" class="headerlink" title="一些反模式"></a>一些反模式</h3><h4 id="CSS-样式紧耦合-HTML-结构"><a href="#CSS-样式紧耦合-HTML-结构" class="headerlink" title="CSS 样式紧耦合 HTML 结构"></a>CSS 样式紧耦合 HTML 结构</h4><p>就像下面的例子一样，很多 CSS 新手（甚至一些经验丰富的老手）都会根据特定的 HTML 结构为组件添加特殊样式。一开始可能不会有什么副作用，不过，我们可以对照上面的原则来测试一下。首先，<code>.widget</code> 是不可预测的，因为我们对 <code>#sidebar</code> 和 <code>body.homepage</code> 下的 <code>.widget</code> 做了特殊处理，导致同样的选择器在页面的不同部分呈现不一样；第二，不满足可复用性，如果我们希望其他页面的某个模块和 <code>body.homepage</code> 下的 <code>.widget</code> 样式一样呢？这时候为了实现效果，我们不得不照搬 <code>body.homepage</code> 下对于 <code>.widget</code> 的特殊处理样式；最后，不满足可维护性，因为一旦我们需要重新设计 <code>.widget</code> 的样式，那么，我们需要将所有的特殊处理找出来并进行重新设计。</p><p>其实，一句话概括就是，我们不应该在一个地方定义了样式，而在其他地方因为业务场景而改变其定义，完全违反了软件开发中的开闭原则。</p><figure class="highlight css"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line"><span class="selector-class">.widget</span> &#123;</div><div class="line">  <span class="attribute">background</span>: yellow;</div><div class="line">  <span class="attribute">border</span>: <span class="number">1px</span> solid black;</div><div class="line">  <span class="attribute">color</span>: black;</div><div class="line">  <span class="attribute">width</span>: <span class="number">50%</span>;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="selector-id">#sidebar</span> <span class="selector-class">.widget</span> &#123;</div><div class="line">  <span class="attribute">width</span>: <span class="number">200px</span>;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="selector-tag">body</span><span class="selector-class">.homepage</span> <span class="selector-class">.widget</span> &#123;</div><div class="line">  <span class="attribute">background</span>: white;</div><div class="line">&#125;</div></pre></td></tr></table></figure><h4 id="过度复杂的选择器"><a href="#过度复杂的选择器" class="headerlink" title="过度复杂的选择器"></a>过度复杂的选择器</h4><p>过度使用复杂的选择器（多层嵌套、链接）意味着深度耦合 HTML 结构，同时增加样式覆盖的难度，无论是哪一个都不利于维护 CSS，因为 HTML 结构不是一成不变的，过度复杂的选择器增加了权重，同时无法复用。</p><figure class="highlight css"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="selector-id">#main-nav</span> <span class="selector-tag">ul</span> <span class="selector-tag">li</span> <span class="selector-tag">ul</span> <span class="selector-tag">li</span> <span class="selector-tag">div</span> &#123; &#125;</div><div class="line"><span class="selector-id">#content</span> <span class="selector-tag">article</span> <span class="selector-tag">h1</span><span class="selector-pseudo">:first-child</span> &#123; &#125;</div><div class="line"><span class="selector-id">#sidebar</span> &gt; <span class="selector-tag">div</span> &gt; <span class="selector-tag">h3</span> + <span class="selector-tag">p</span> &#123; &#125;</div></pre></td></tr></table></figure><h4 id="过于通用的-CSS-类名"><a href="#过于通用的-CSS-类名" class="headerlink" title="过于通用的 CSS 类名"></a>过于通用的 CSS 类名</h4><p>在设计组件的时候，通常会将组件的子元素类名嵌套定义于组件内部，然而如果子元素的类名过于通用，则很容易导致不可预测的 CSS 样式，因为这样虽然防止组件内部的样式影响页面其他部分，但却无法防止页面其他部分不影响组件的样式。比如下面的 <code>.title</code></p><figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"widget"</span>&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">h3</span> <span class="attr">class</span>=<span class="string">"title"</span>&gt;</span>...<span class="tag">&lt;/<span class="name">h3</span>&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"contents"</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">button</span> <span class="attr">class</span>=<span class="string">"action"</span>&gt;</span>Click Me!<span class="tag">&lt;/<span class="name">button</span>&gt;</span></div><div class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></div></pre></td></tr></table></figure><figure class="highlight css"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="selector-class">.widget</span> &#123;&#125;</div><div class="line"><span class="selector-class">.widget</span> <span class="selector-class">.title</span> &#123;&#125;</div><div class="line"><span class="selector-class">.widget</span> <span class="selector-class">.contents</span> &#123;&#125;</div><div class="line"><span class="selector-class">.widget</span> <span class="selector-class">.action</span> &#123;&#125;</div></pre></td></tr></table></figure><h4 id="杂糅太多-CSS-规则"><a href="#杂糅太多-CSS-规则" class="headerlink" title="杂糅太多 CSS 规则"></a>杂糅太多 CSS 规则</h4><p>在一个选择器中定义太多的 CSS 规则并不是好的方法，这样就失去了灵活性，不易复用。比如像布局、定位这一类的规则应该在组件外部定义，不具有复用性，而组件的颜色、字体大小、交互细节等等易于复用，同时也是该组件的真实表现，应该封装于组件内部。</p><figure class="highlight css"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="selector-class">.widget</span> &#123;</div><div class="line">  <span class="attribute">position</span>: absolute;</div><div class="line">  <span class="attribute">top</span>: <span class="number">20px</span>;</div><div class="line">  <span class="attribute">left</span>: <span class="number">20px</span>;</div><div class="line">  <span class="attribute">background-color</span>: red;</div><div class="line">  <span class="attribute">font-size</span>: <span class="number">1.5em</span>;</div><div class="line">  <span class="attribute">text-transform</span>: uppercase;</div><div class="line">&#125;</div></pre></td></tr></table></figure><h3 id="一些建议"><a href="#一些建议" class="headerlink" title="一些建议"></a>一些建议</h3><h4 id="类名语义化、表明意图"><a href="#类名语义化、表明意图" class="headerlink" title="类名语义化、表明意图"></a>类名语义化、表明意图</h4><p>语义化的类名应该能清晰地表明 CSS 的表现内容及其作用对象，使其可预测。</p><h4 id="去权重"><a href="#去权重" class="headerlink" title="去权重"></a>去权重</h4><p>保持选择器的低权重是编写轻量级、可复用及可维护的 CSS 的关键，权重太大不利于灵活复用。id选择器的权重太大，同时id表示元素唯一，不适用于应用样式，除了以下场景，应当避免使用：</p><ul><li><p>关联 label 标签</p></li><li><p>作为 hash URL</p></li><li><p>关联 aria 属性，增加可访问性</p></li><li><p>用于BI埋点、自动化测试</p></li></ul><p>具体关于权重的计算可参考：<a href="/2017/03/28/css-specific-and-priority/" title="CSS 权重及优先级">CSS 权重及优先级</a></p><h4 id="避免全局选择器（-，标签选择器，属性选择器）"><a href="#避免全局选择器（-，标签选择器，属性选择器）" class="headerlink" title="避免全局选择器（*，标签选择器，属性选择器）"></a>避免全局选择器（*，标签选择器，属性选择器）</h4><h4 id="单一职责，划分样式"><a href="#单一职责，划分样式" class="headerlink" title="单一职责，划分样式"></a>单一职责，划分样式</h4><h4 id="模块化命名"><a href="#模块化命名" class="headerlink" title="模块化命名"></a>模块化命名</h4><h4 id="区分样式及非样式"><a href="#区分样式及非样式" class="headerlink" title="区分样式及非样式"></a>区分样式及非样式</h4><h4 id="类-BEM-命名"><a href="#类-BEM-命名" class="headerlink" title="类 BEM 命名"></a>类 BEM 命名</h4><ul><li><p>Block</p></li><li><p>Element</p></li><li><p>Modifier</p></li><li><p>State</p><ul><li><p>显示/隐藏</p></li><li><p>激活/未激活</p></li><li><p>禁用/非禁用</p></li><li><p>加载中/加载完毕</p></li></ul></li></ul><h4 id="正确使用-extend"><a href="#正确使用-extend" class="headerlink" title="正确使用 @extend"></a>正确使用 @extend</h4><p>参考：</p><ul><li><p><a href="https://philipwalton.com/articles/css-architecture/" target="_blank" rel="external">CSS Architecture – Philip Walton @ Google</a></p></li><li><p><a href="http://maintainablecss.com/" target="_blank" rel="external">maintainablecss</a></p></li></ul></main><!-- navigation --><nav class="post-nav"><a href="/2017/03/28/css-specific-and-priority/" class="post-nav--link"><strong class="post-nav--caption">上一篇</strong><div class="post-nav--title">CSS 权重及优先级</div></a><a href="/2017/03/25/dom-event/" class="post-nav--link"><strong class="post-nav--caption">下一篇</strong><div class="post-nav--title">DOM 事件模型详解</div></a></nav><!-- footer --></article><aside class="side-bar"><div class="side-bar--wrapper"><nav class="post-nav"><a href="/2017/03/28/css-specific-and-priority/" class="post-nav--link"><strong class="post-nav--caption">上一篇</strong> </a><a href="/2017/03/25/dom-event/" class="post-nav--link"><strong class="post-nav--caption">下一篇</strong></a></nav><!-- toc --><ul class="toc"><li class="toc--item"><a title="良好的 CSS 架构" class="toc--item--anchor" href="#良好的-CSS-架构" data-depth="0"><span class="toc--number">1</span>良好的 CSS 架构</a></li><li class="toc--item"><a title="可预测的" class="toc--item--anchor" href="#可预测的" data-depth="1"><span class="toc--number">1.1</span>可预测的</a></li><li class="toc--item"><a title="可复用的" class="toc--item--anchor" href="#可复用的" data-depth="1"><span class="toc--number">1.2</span>可复用的</a></li><li class="toc--item"><a title="可维护的" class="toc--item--anchor" href="#可维护的" data-depth="1"><span class="toc--number">1.3</span>可维护的</a></li><li class="toc--item"><a title="弹性伸缩的" class="toc--item--anchor" href="#弹性伸缩的" data-depth="1"><span class="toc--number">1.4</span>弹性伸缩的</a></li><li class="toc--item"><a title="一些反模式" class="toc--item--anchor" href="#一些反模式" data-depth="0"><span class="toc--number">2</span>一些反模式</a></li><li class="toc--item"><a title="CSS 样式紧耦合 HTML 结构" class="toc--item--anchor" href="#CSS-样式紧耦合-HTML-结构" data-depth="1"><span class="toc--number">2.1</span>CSS 样式紧耦合 HTML 结构</a></li><li class="toc--item"><a title="过度复杂的选择器" class="toc--item--anchor" href="#过度复杂的选择器" data-depth="1"><span class="toc--number">2.2</span>过度复杂的选择器</a></li><li class="toc--item"><a title="过于通用的 CSS 类名" class="toc--item--anchor" href="#过于通用的-CSS-类名" data-depth="1"><span class="toc--number">2.3</span>过于通用的 CSS 类名</a></li><li class="toc--item"><a title="杂糅太多 CSS 规则" class="toc--item--anchor" href="#杂糅太多-CSS-规则" data-depth="1"><span class="toc--number">2.4</span>杂糅太多 CSS 规则</a></li><li class="toc--item"><a title="一些建议" class="toc--item--anchor" href="#一些建议" data-depth="0"><span class="toc--number">3</span>一些建议</a></li><li class="toc--item"><a title="类名语义化、表明意图" class="toc--item--anchor" href="#类名语义化、表明意图" data-depth="1"><span class="toc--number">3.1</span>类名语义化、表明意图</a></li><li class="toc--item"><a title="去权重" class="toc--item--anchor" href="#去权重" data-depth="1"><span class="toc--number">3.2</span>去权重</a></li><li class="toc--item"><a title="避免全局选择器（*，标签选择器，属性选择器）" class="toc--item--anchor" href="#避免全局选择器（-，标签选择器，属性选择器）" data-depth="1"><span class="toc--number">3.3</span>避免全局选择器（*，标签选择器，属性选择器）</a></li><li class="toc--item"><a title="单一职责，划分样式" class="toc--item--anchor" href="#单一职责，划分样式" data-depth="1"><span class="toc--number">3.4</span>单一职责，划分样式</a></li><li class="toc--item"><a title="模块化命名" class="toc--item--anchor" href="#模块化命名" data-depth="1"><span class="toc--number">3.5</span>模块化命名</a></li><li class="toc--item"><a title="区分样式及非样式" class="toc--item--anchor" href="#区分样式及非样式" data-depth="1"><span class="toc--number">3.6</span>区分样式及非样式</a></li><li class="toc--item"><a title="类 BEM 命名" class="toc--item--anchor" href="#类-BEM-命名" data-depth="1"><span class="toc--number">3.7</span>类 BEM 命名</a></li><li class="toc--item"><a title="正确使用 @extend" class="toc--item--anchor" href="#正确使用-extend" data-depth="1"><span class="toc--number">3.8</span>正确使用 @extend</a></li></ul></div></aside></div></main><footer class="site--footer"><div class="wrapper"><h2 class="footer--heading">天枢</h2><div class="footer-col-wrapper"><div class="footer-col footer-col---3"><ul class="slash-list"><li>他强由他强，清风拂山岗</li><li><a rel="license" href="http://creativecommons.org/licenses/by-nc-nd/3.0/"><img alt="知识共享许可协议" style="border-width: 0" src="https://i.creativecommons.org/l/by-nc-nd/3.0/80x15.png"></a></li></ul></div></div></div></footer><script src="/assets/blog/js/manifest.js"></script><script src="/assets/blog/js/vendor.js"></script><script src="/assets/blog/js/main.js"></script></body></html>